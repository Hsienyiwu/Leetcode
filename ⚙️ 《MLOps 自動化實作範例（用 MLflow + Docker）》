ğŸ§© ä¸‰ã€æ­¥é©Ÿæµç¨‹
Step 1ï¸âƒ£ï¼šå»ºç«‹ MLflow Tracking Server
mlflow server \
  --backend-store-uri sqlite:///mlflow.db \
  --default-artifact-root ./mlruns \
  --host 0.0.0.0 --port 5000


Step 2ï¸âƒ£ï¼šè¨“ç·´ä¸¦è¿½è¹¤æ¨¡å‹
import mlflow
import mlflow.sklearn
from sklearn.ensemble import RandomForestClassifier
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split

mlflow.set_tracking_uri("http://localhost:5000")
mlflow.set_experiment("iris_rf_demo")

X, y = load_iris(return_X_y=True)
X_train, X_test, y_train, y_test = train_test_split(X, y)

with mlflow.start_run():
    clf = RandomForestClassifier(n_estimators=100, max_depth=3)
    clf.fit(X_train, y_train)

    acc = clf.score(X_test, y_test)
    mlflow.log_metric("accuracy", acc)
    mlflow.sklearn.log_model(clf, "model")


Step 3ï¸âƒ£ï¼šæ¨¡å‹ç‰ˆæœ¬ç®¡ç†ï¼ˆRegistryï¼‰
result = mlflow.register_model(
    "runs:/<run_id>/model",
    "iris_classifier"
)

Step 4ï¸âƒ£ï¼šä½¿ç”¨ Docker å°è£æ¨¡å‹æœå‹™
å»ºç«‹ Dockerfileï¼š
FROM python:3.9
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY . .
CMD ["mlflow", "models", "serve", "-m", "models:/iris_classifier/1", "-p", "1234", "--host", "0.0.0.0"]
ç„¶å¾Œï¼š
docker build -t iris-mlflow .
docker run -p 1234:1234 iris-mlflow
ğŸ”¹ æ­¤æ™‚å³å¯é€é http://localhost:1234/invocations ç”¨ JSON è«‹æ±‚é€²è¡Œé æ¸¬ã€‚

Step 5ï¸âƒ£ï¼šæ¸¬è©¦æ¨è«– API
curl -X POST http://127.0.0.1:1234/invocations \
  -H "Content-Type: application/json" \
  -d '{"columns":["sepal_length","sepal_width","petal_length","petal_width"],
       "data":[[5.1,3.5,1.4,0.2]]}'
âœ… è¿”å›é æ¸¬çµæœ (e.g. [0])ã€‚

